{"version":3,"sources":["0"],"names":["global","factory","exports","module","require","define","amd","globalThis","self","Upscaler","tf","DefaultUpscalerJSModel","this","tf$1","DefaultUpscalerModel","_interopDefaultLegacy","e","default","_interopNamespace","__esModule","n","Object","create","keys","forEach","k","d","getOwnPropertyDescriptor","defineProperty","get","enumerable","freeze","MODEL_DEFINITION_VALIDATION_CHECK_ERROR_TYPE","tf__namespace$1","DefaultUpscalerModel__default","tf__namespace","isShape4D","Boolean","shape","Array","isArray","length","val","makeIsNDimensionalTensor","rank","pixels","err","isFourDimensionalTensor","isThreeDimensionalTensor","isTensor","input","Tensor","isString","el","isValidModelType","modelType","includes","ModelDefinitionValidationError","Error","type","constructor","super","isValidModelDefinition","undefined","modelDefinition","UNDEFINED","INVALID_MODEL_TYPE","path","MISSING_PATH","isNumber","isValidRange","range","every","isLayersModel","model","LayersModel","AbortError","message","ERROR_INVALID_MODEL_TYPE_URL","ERROR_WITH_MODEL_INPUT_SHAPE_URL","ERROR_MISSING_MODEL_DEFINITION_PATH","join","ERROR_INVALID_MODEL_TYPE","JSON","stringify","ERROR_MODEL_DEFINITION_BUG","WARNING_INPUT_SIZE_AND_PATCH_SIZE","ERROR_WITH_MODEL_INPUT_SHAPE","inputShape","warn","console","msg","isProgress","p","isMultiArgTensorProgress","output","progressOutput","isAborted","abortSignal","aborted","async","wrapGenerator","gen","postNext","let","result","next","done","value","tensorAsClampedArray","tidy","height","width","tensor","fill","expandDims","clipByValue","concat","dataSync","nonNullable","processAndDisposeOfTensor","_processFns","processFns","filter","processedTensor","reduce","reducedTensor","processFn","isDisposed","dispose","loadTfModel","modelPath","loadGraphModel","loadLayersModel","getBatchInputShape","layers","batchInputShape","inputs","getInputShape","scaleIncomingPixels","mul","isInputSizeDefined","parsePatchAndInputSizes","patchSize","padding","padInput","pixelsHeight","pixelsWidth","Math","max","rightTensor","zeros","bottomTensor","topTensor","trimInput","imageSize","scale","slice","scaleOutput","endingRange","getOutputOption","CDN_PATH_DEFINITIONS","jsdelivr","packageName","version","unpkg","CDNS","getLoadModelErrorMessage","packageInformation","errs","name","map","cdn","fetchModel","i","getCDNFn","push","loadModel","error","getModelDefinitionError","makeTick","signal","awaitNextFrame","nextFrame","r","isWarmupSizeByPatchSize","size","isNumericWarmupSize","ERROR_INVALID_WARMUP_VALUE_URL","ERROR_INVALID_WARMUP_VALUE","getInvalidValueError","getWidthAndHeight$1","amount","getSizesAsArray","sizes","cancellableWarmup","modelPackage","internalArgs","tick","dummyTensor","fns","preprocess","predict","t","postprocess","fn","warmup","ERROR_ENVIRONMENT_DISALLOWS_BASE64_URL","ERROR_ENVIRONMENT_DISALLOWS_STRING_INPUT_URL","getEnvironmentDisallowsStringInput","getEnvironmentDisallowsBase64","getInvalidTensorError","getInvalidImageError","loadImage","Promise","resolve","reject","img","Image","src","crossOrigin","onload","onerror","fromPixels","browser","fromPixelsAsync","getTensorFromInput","imgHTMLElement","getImageAsTensor","expandedTensor","tensorAsBase64","arr","imageData","ImageData","canvas","data","set","document","createElement","ctx","getContext","putImageData","toDataURL","checkIfValidEnvironment","errFn","checkValidEnvironment","WARNING_UNDEFINED_PADDING","WARNING_PROGRESS_WITHOUT_PATCH_SIZE","ERROR_INVALID_TENSOR_PREDICTED_URL","ERROR_INVALID_TENSOR_PREDICTED","ERROR_INVALID_MODEL_PREDICTION","GET_INVALID_SHAPED_TENSOR","GET_UNDEFINED_TENSORS_ERROR","getWidthAndHeight","getRowsAndColumns","rows","ceil","columns","checkAndAdjustStartingPosition","dimension","origin","sliceOrigin","checkAndAdjustEndingPosition","endPosition","sliceEndPosition","compensatingAmount","sliceAmount","checkAndAdjustSliceSize","GET_TENSOR_DIMENSION_ERROR_ROW_IS_UNDEFINED","GET_TENSOR_DIMENSION_ERROR_COL_IS_UNDEFINED","GET_TENSOR_DIMENSION_ERROR_PATCH_SIZE_IS_UNDEFINED","GET_TENSOR_DIMENSION_ERROR_HEIGHT_IS_UNDEFINED","GET_TENSOR_DIMENSION_ERROR_WIDTH_IS_UNDEFINED","getTensorDimensions","row","col","yPatchSize","xPatchSize","sliceSize","concatTensors","tensors","axis","definedTensors","concatenatedTensor","getPercentageComplete","total","executeModel","predictedPixels","progress","inputSize","upscaledTensor","colTensor","slicedPixels","prediction","startSlice","endSlice","slicedPrediction","processedPrediction","outputRange","percent","squeezedTensor","squeeze","processedUpscaledTensor","clone","postprocessedTensor","getCopyOfInput","cancellableUpscale","args","upscaledPixels","parsedInput","startingPixels","preprocessedPixels","inputRange","base64Src","upscale","DEFAULT_MODEL","_opts","_model","ready","_abortController","AbortController","opts","then","warmupSizes","catch","execute","image","options","getUpscaleOptions","bind","abort","getModel"],"mappings":"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"}